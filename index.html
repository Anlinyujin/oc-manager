<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="OC">
<meta name="theme-color" content="#ffffff">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-192.png">
<link rel="stylesheet" href="css/style.css">
<title>OC</title>
</head>
<body>

<div id="debugBar" style="position:fixed;bottom:0;left:0;right:0;background:#ff0;color:#000;font-size:12px;padding:8px;z-index:9999;max-height:30vh;overflow:auto;display:none;font-family:monospace;"></div>

<script>
window.onerror = function(msg, url, line, col, error) {
  var d = document.getElementById('debugBar');
  d.style.display = 'block';
  d.innerHTML += '<div style="margin-bottom:4px;border-bottom:1px solid #ccc;padding-bottom:4px;">' +
    'âŒ ' + msg + '<br>' +
    'ğŸ“ ' + (url ? url.split('/').pop() : '?') + ' ç¬¬' + line + 'è¡Œ' +
    '</div>';
  return false;
};
</script>

<div class="topbar" id="topbar">
  <button class="btn-icon" id="menuBtn" aria-label="èœå•">
    <div class="hamburger"><span></span><span></span><span></span></div>
  </button>
  <span class="topbar-title" id="topbarTitle"></span>
  <span class="save-indicator" id="saveIndicator">å·²ä¿å­˜</span>
  <button class="btn-icon hidden" id="topbarRightBtn" aria-label="åˆ‡æ¢">
    <span id="topbarRightIcon"></span>
  </button>
</div>

<div class="sidebar-overlay" id="sidebarOverlay"></div>
<div class="sidebar" id="sidebar">
  <div class="sidebar-header" id="sidebarHome">OC</div>
  <nav class="sidebar-nav">
    <div class="sidebar-item" id="navCharCards">äººè®¾å¡</div>
    <div class="sidebar-item" id="navNotes">ç¬”è®°</div>
    <div class="sidebar-item" id="navTags">æ ‡ç­¾ç®¡ç†</div>
  </nav>
  <div class="sidebar-footer">
    <div class="sidebar-footer-item" id="navBackup">å¤‡ä»½æ•°æ®</div>
    <div class="sidebar-footer-item" id="navRestore">æ¢å¤æ•°æ®</div>
  </div>
</div>

<div class="main" id="mainContent">
  <div class="page page-home active" id="pageHome">
    <span class="home-face">â©ŒâŒ¯â©Œ</span>
  </div>
  <div class="page" id="pageCharList"></div>
  <div class="page" id="pageCharEdit"></div>
  <div class="page" id="pageCharPreview"></div>
  <div class="page" id="pageNoteList"></div>
  <div class="page" id="pageNoteEdit"></div>
  <div class="page" id="pageTagManager"></div>
</div>

<div class="export-bottom-bar" id="exportBottomBar">
  <button class="export-confirm-btn" id="exportConfirmBtn">ç¡®è®¤å¯¼å‡º (0)</button>
</div>

<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <div class="modal-body" id="modalBody"></div>
    <div class="modal-actions" id="modalActions"></div>
  </div>
</div>

<div class="toast" id="toast"></div>
<input type="file" id="fileInput" accept=".json" style="display:none">

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="js/ui.js"></script>
<script src="js/data.js"></script>
<script src="js/markdown.js"></script>
<script src="js/characters.js"></script>
<script src="js/notes.js"></script>
<script src="js/tags.js"></script>
<script src="js/app.js"></script>

<script>
// åŠ è½½å®Œæˆåæ£€æŸ¥å‡½æ•°æ˜¯å¦å­˜åœ¨
window.addEventListener('load', function() {
  var d = document.getElementById('debugBar');
  var checks = {
    'renderCharList': typeof renderCharList,
    'renderNoteList': typeof renderNoteList,
    'renderTagManager': typeof renderTagManager,
    'renderCharEdit': typeof renderCharEdit,
    'navigateTo': typeof navigateTo,
    'showModal': typeof showModal,
    'loadData': typeof loadData,
    'renderMarkdown': typeof renderMarkdown
  };
  var hasError = false;
  for (var k in checks) {
    if (checks[k] !== 'function') {
      d.style.display = 'block';
      d.innerHTML += '<div>âš ï¸ ' + k + ' = ' + checks[k] + '</div>';
      hasError = true;
    }
  }
  if (!hasError) {
    d.style.display = 'block';
    d.innerHTML = '<div style="color:green;">âœ… æ‰€æœ‰å‡½æ•°åŠ è½½æ­£å¸¸</div>';
    setTimeout(function() { d.style.display = 'none'; }, 3000);
  }
});
</script>

</body>
</html>
